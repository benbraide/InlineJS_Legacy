<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InlineJS Test Page</title>
</head>
<body>
    <h1>InlineJS</h1>
    <div>
        <h2>Examples Links</h2>
        <ul>
            <li>
                <a href="/examples/tags.html">Tags</a>
            </li>
        </ul>
    </div>
    <div x-component="first" x-data="{email: 'user.yahoo@yahoo.com', name: 'John Doe', state: true, getName(){ return this.name }}">
        <h2 x-style:color="color" x-on:click="color = 'red'">First Component</h2>
        <div>
            <span>Name: </span>
            <strong x-text="name"></strong>
        </div>
        <div>
            <span>Name (by getName): </span>
            <strong x-text="getName"></strong>
        </div>
        <div>
            <span>Name (by $component): </span>
            <strong x-text="$component('first').name"></strong>
        </div>
        <div>
            <span>Email: </span>
            <strong x-text="email"></strong>
        </div>
        <div>
            <input type="text" x-model="name">
        </div>
        <div>
            <label>
                <input type="checkbox" x-model="state"> State
            </label>
        </div>
        <div>
            <span>State: </span>
            <strong x-text="state"></strong>
        </div>
        <p x-uninit="$console.log('State was changed to false', $self)" x-if="state">State is true</p>
        <p x-uninit="$console.log('State was changed to true', $self)" x-if="!state">State is false</p>
    </div>
    <div x-data="{list: ['First', 'Second', 'Third', 'Last']}">
        <h2>Array Loop</h2>
        <div x-each="list as item">
            <span>Index: </span><strong x-text="$each.index"></strong> | 
            <span>Value: </span><strong x-text="$each.value"></strong> | 
            <span>Value(alt): </span><strong x-text="item"></strong> | 
            <span>Count: </span><strong x-text="$each.count"></strong>
        </div>
    </div>
    <div x-data="{range: 9}">
        <h2>Range Loop</h2>
        <div x-each.reverse.count="range">
            <span>Index: </span><strong x-text="$each.index"></strong> | 
            <span>Value: </span><strong x-text="$each.value"></strong> | 
            <span>Count: </span><strong x-text="$each.count"></strong>
        </div>
    </div>
    <div x-data="{list: {name: {first: 'Anon Legion', second:'Anon Legion2'}, email: {first:'anon.legion@crypt.co',second:'a@b.c'}, age: {first:27,second:45}, sex: {first:'MALE',second:'FEMALE'}}}">
        <h2>Map Loop</h2>
        <div x-each="list as item">
            <span>Index: </span><strong x-text="$each.index"></strong> | 
            <span>Value: </span><strong x-text="$each.value.first"></strong> | <strong x-text="$each.value.second"></strong> | 
            <span>Value(alt): </span><strong x-text="item.first"></strong> | <strong x-text="item.second"></strong> | 
            <span>Count: </span><strong x-text="$each.count"></strong>
        </div>
    </div>
    <div x-data="cartData()" x-component="cart">
        <h2>Product Cart (<span x-text="getCount()"></span>)</h2>
        <hr>
        <div x-each="list">
            <div>
                <span>SKU: </span><strong x-text="$each.index"></strong>
            </div>
            <div>
                <span>Title: </span><strong x-text="$each.value.title"></strong>
            </div>
            <div>
                <span>Price: </span><strong x-text="$each.value.price"></strong>
            </div>
            <div>
                <span>Quantity: </span><strong x-text="$each.value.quantity"></strong>
            </div>
            <div>
                <button x-on:click="$each.value.quantity += (($each.value.quantity > 0) ? -1 : 0)">-</button>
                <button x-on:click="$each.value.quantity += 1">+</button>
            </div>
            <hr>
        </div>
    </div>
    <div x-data="{list: [], add(){if (!this.input){return} this.list.push({text:this.input, editing: false}); this.input = ''}, remove(index){this.list.splice(index, 1)}}">
        <h2>TODO List</h2>
        <input type="text" placeholder="Type here" x-model="input" x-on:keydown.enter="add()">
        <button x-on:click="add()">Add</button>
        <hr>
        <ul>
            <li style="margin-top: 5px;" x-each="list">
                <span style="text-transform: uppercase" x-text="$each.value.text" x-show="!$each.value.editing"></span>
                <input type="text" x-model="$each.value.text" x-show="$each.value.editing" x-on:keydown.enter="$each.value.editing = false">
                <button style="background-color: transparent; color: gray; border: 1px solid gray" x-on:click="$each.value.editing = true" x-show="!$each.value.editing">...</button>
                <button style="background-color: transparent; color: red; border: 1px solid red" x-on:click="remove($each.index)">x</button>
            </li>
        </ul>
    </div>
    <div x-data>
        <h2>State</h2>
        <input type="email" x-state.lazy x-bind="function(){isTyping = $state.isTyping;isDirty = $state.isDirty;isValid = $state.isValid;}">
        <div>
            <span>Typing: </span><strong x-text="isTyping"></strong>
        </div>
        <div>
            <span>Dirty: </span><strong x-text="isDirty"></strong>
        </div>
        <div>
            <span>Valid: </span><strong x-text="isValid"></strong>
        </div>
    </div>
    <div x-component="state" x-data>
        <h2>Group State</h2>
        <form x-ref="form" x-state.delay.3s x-bind="[isValid, isTyping, isDirty] = [$state.isValid, $state.isTyping, $state.isDirty]">
            <div>
                Name: <input type="text" value="Anon User" required>
            </div>
            <div>
                Email: <input type="email" value="anon.user@teep.com" required>
            </div>
            <div>
                <span>Typing: </span><strong x-text="isTyping"></strong>
            </div>
            <div>
                <span>Global Typing: </span><strong x-text="$$state($refs.form).isTyping"></strong>
            </div>
            <div>
                <span>Dirty: </span><strong x-text="$state.isDirty"></strong>
            </div>
            <div>
                <span>Valid: </span><strong x-text="$state.isValid"></strong>
            </div>
            <div>
                <button type="reset" x-on:click="$nextTick(() => {$$state($refs.form).reset()})">Reset</button>
                <button class="ml-4 themed" :disabled="!isValid">Continue to payment</button>
            </div>
        </form>
    </div>
    <div x-component="attr" x-ref="root" x-attr-change="attr" x-data>
        <h2>Attribute Change</h2>
        <input type="text" placeholder="Attribute Name" x-model.out="uname">
        <input type="text" placeholder="Attribute Value" x-model.out="uvalue">
        <button x-on:click="$parent.setAttribute(uname, uvalue)">Update</button>
        <div>
            <span>Name: </span><strong x-text="$use(attr.name)"></strong>
        </div>
        <div>
            <span>Value: </span><strong x-text="attr ? attr.value : ''"></strong>
        </div>
        <div>
            <span>Name (from '$attr'): </span><strong x-text="$attr.name"></strong>
        </div>
        <div>
            <span>Value (from '$attr'): </span><strong x-text="$attr.value"></strong>
        </div>
    </div>
    <div x-data>
        <h2>Borrowed Component</h2>
        <div>
            <span>Name (from 'first' component): </span>
            <strong x-text="$component('first').name"></strong>
        </div>
        <div>
            <span>Name (from 'first' component by getName): </span>
            <strong x-text="$component('first').getName()"></strong>
        </div>
        <div>
            <span>Global Typing (borrowed): </span>
            <strong x-text="$$state($component('state').$refs.form).isTyping"></strong>
        </div>
        <div>
            <span>Global Attr Name (borrowed): </span><strong x-text="$$attr($component('attr').$refs.root).name"></strong>
        </div>
        <div>
            <span>Global Attr Value (borrowed'): </span><strong x-text="$$attr($component('attr').$refs.root).value"></strong>
        </div>
    </div>
    <script src="/dist/inlinejs.min.js"></script>
    <script src="/dist/inlinejs-extended.min.js"></script>
    <script>
        InlineJS.Region.enableOptimizedBinds = false;
        InlineJS.Bootstrap.Attach();

        function cartData(){
            return {
                list: {
                    'PRD_0001': {
                        title: 'White Bread',
                        price: 4.59,
                        quantity: 2
                    },
                    'PRD_0080': {
                        title: 'Peanut Butter',
                        price: 7.02,
                        quantity: 5
                    }
                },
                getCount(){
                    let count = 0;
                    for (let key in this.list){
                        count += this.list[key].quantity;
                    }
                    return count;
                }
            };
        }
    </script>
</body>
</html>